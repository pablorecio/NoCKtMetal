% ===================================================================
%                   Presentación con Latex Beamer
% ===================================================================
\documentclass[9pt,xcolor=svgnames]{beamer}
%\documentclass[handout,xcolor=svgnames]{beamer} %Version imprimible
% -------------------------------------------------------------------
% Paquetes personalizados
\usepackage{../paquetes}
\usepackage{../colores}
\usepackage{../info}
\usepackage{../modo}
% -------------------------------------------------------------------

% Comienza el documento
\begin{document}
% Tikz -> Imágenes
\tikzstyle{every picture}+=[remember picture]
% Entorno matemático
\everymath{\displaystyle}
% -------------------------------------------------------------------
\subtitle{El retorno del proyecto}
\date{Mayo 2009}
% -------------------------------------------------------------------
% Fondo blanco: primera página
% ------------------------------------------------------------------

\beamersetaveragebackground{white}

\begin{frame}
 \thispagestyle{empty}
 \begin{figure}[t]
  \centering
  \includegraphics[scale=0.4]{./Imagenes/logo_cachimba.pdf}

\noindent \Huge Presenta...
\end{figure}
\end{frame}


\begin{frame}
 \thispagestyle{empty}
 
 \animate<2-3> 
 \begin{figure}[t]
  \centering
  \includegraphics<1>[scale=0.7]{../Imagenes/logo_1.pdf}
  \includegraphics<2>[scale=0.7]{../Imagenes/logo_2.pdf}
  \includegraphics<3>[scale=0.7]{../Imagenes/logo_3.pdf}
  \includegraphics<4>[scale=0.7]{../Imagenes/logo_4.pdf}
 \end{figure}
\end{frame}


% -------------------------------------------------------------------
% Fondo para el resto del documento
\setbeamertemplate{background}{
\includegraphics[width=\paperwidth,height=\paperheight]
{../Imagenes/fondo.pdf}
}
% -------------------------------------------------------------------


% Continuación:
% Transparencia de Inicio -> Título
\begin{frame}
 \titlepage
\end{frame}

\normalsize

% Transparencia de índice
\begin{frame}{Índice} 
 \transdissolve
 \tableofcontents
\end{frame}
  
  
 \section{Estado del proyecto}
 
  \subsection{Actualización de la planificación}
  
  \begin{frame}{Diagrama de Gannt}
   
  \begin{figure}[t]
    \includegraphics[scale=0.2]{./Imagenes/gannt.pdf}
   \end{figure}
   
  \end{frame}
   
   
   
   \subsection{Modificaciones sufridas por el proyecto}
   
   \begin{frame}{Modificaciones y justificaciones}
    
    \begin{itemize}
     \item Desde la anterior presentación no hemos considerado
	   ninguna modificación del proyecto inicial, por lo
	   estamos siguiendo el plan inicial.
	 
     \end{itemize}
    
    
   \end{frame}
   
   
 \section{Presentación Previa del producto}
 
   \subsection{Producto actual}

   \begin{frame}{Estado actual: Motor de Combate}
    \begin{itemize}
     \item Inclusión de una simple IA para los rivales
     \item Mejora de la serialización de los objetos, añadiendo
	   construcciones desde ficheros.
     \item Adquisición de experiencia de los PJs
     \item Más grupos enemigos con distintas cualidades cada uno.
     \item Clase \texttt{Biblioteca} que indexa los datos para 
	   guardados de partida.
     \item Solucionados algunos bugs críticos
    \end{itemize}
   \end{frame}

   \begin{frame}{Captura de pantalla: Motor de combate}
    
   \end{frame}

   \begin{frame}{Estado actual: Motor de movimiento}
    \begin{itemize}
     \item Añadidos NPJs en el motor, ampliando la funcionalidad del mismo.
     \item Añadidas las funcionalidades de diálogos entre PJs y NPJs.
     \item Tratamiento de eventos para futura interaccion entre PJs y
	   NPJs u objetos
     \item Mejora de las colisiones en el mapa, detectando además los NPJ
     \item Solucionados algunos bugs y re-escritura de algunas clases
	   para una mejor cohesión
     \item Menu inicial :)
    \end{itemize}
   \end{frame}


   \begin{frame}{Captura de pantalla: Motor gráfico}
    
   \end{frame}

   \subsection{Inteligencia Artificial}
   \begin{frame}
     La IA solo es utilizada en el motor de combate, y no es una IA
     demasiado crítica, ya que no tiene que actuar en tiempo real, y
     las variables de decisión no son demasiado complejas.\\

     Por ahora, solo realiza ataques simples. En la próxima versión hará
     ataques, usará objetos e incluso puede que intente huir.\\

     \begin{block}{Secuencia}
       \begin{itemize}
       \item Comprueba el porcentaje de vida de cada rival.
       \item Asigna una puntuación en función del porcentaje de vida,
         de forma que el que tiene menos vida, tiene una puntuación más alta.
       \item Se realiza una tirada pseudo-aleatoria, de forma que los
         que tienen menos vida es más posible que sean atacados que el resto.
       \end{itemize}
     \end{block}
   \end{frame}
   

 \section{Calidad de la implementación}
 
  \subsection{Calidad del codigo}
  
  \begin{frame}[fragile=singleslide]{Clase \textbf{Combatiente} (1)}

   \begin{lstlisting}[style=C++]
    #ifndef _COMBATIENTE_H
    #define _COMBATIENTE_H

    #include .......

    class Combatiente: public Atributos {
      public:
      class AtaqueFallado: public std::exception {
        public:
        const char* what() const throw () {
          return "El ataque ha fallado!";
        }
      };

      Combatiente(std::string nombre, Uint32 id, AtributoBase atr,
                  Grupo &grupo,
                  std::pair<Uint32, Uint32> rangoArma, string rXML, 
                  Uint32 exp = 0, Uint32 exp_ganable = 0, 
                  Uint32 aciertoArma = 15, Uint32 armadura = 20);
      \end{lstlisting}
    
    \end{frame}
    
  \begin{frame}[fragile=singleslide]{Clase \textbf{Combatiente} (2)}
   \begin{lstlisting}[style=C++]
                  
      Combatiente(const char* ruta_XML) {
        cargar_XML(*this, ruta_XML);
      }

      /*--- METODOS GETTER----*/
      .......
      /*----------------------*/
      Uint32 tiradaArma() const {
        Aleatorio a;
        return a.valorEntero(_rangoArma.first, _rangoArma.second);
      }
      void addHabilidad(Habilidad& h);
      Uint32 ataqueSimple(Combatiente &objetivo) throw(AtaqueFallado);
      Uint32 usarObjeto(Uint32 i, Combatiente& objetivo) throw (Inventario::ObjetoNoEnInventario,
                       Objeto::CantidadItemInsuficiente);
      Uint32 ataqueEspecial(Uint32 i, Combatiente& objetivo);
      void actualizarXML() {
        guardar_XML(*this, _ruta_XML.c_str());
      }
   
   \end{lstlisting}
   
  \end{frame}
  \begin{frame}[fragile=singleslide]{Clase \textbf{Combatiente} (y 3)}
   \begin{lstlisting}[style=C++]
     private:
       std::string _nombre;
       Uint32 _idCombatiente
       std::map<Uint32, Habilidad*> _habilidades;
       Inventario *_inventario;
       Grupo* _grupo;
       bool _pasarTurno;
       Uint32 _experienciaGanable;
       std::pair<Uint32, Uint32> _rangoArma;
       Uint32 _aciertoArma;
       Uint32 _armadura;
       friend class boost::serialization::access;

       template<class Archive>
       void serialize(Archive & ar, const unsigned int version)
   \end{lstlisting}
 \end{frame}
 
  \subsection{Ejemplos de código}
  
  \begin{frame}{Ejemplo: Clase x}
   combatiente.h recortado xD
  \end{frame}
  
  
  \begin{frame}{Ejemplo: Interfaz principal entre clases}
   personaje.h
  \end{frame}
    
  


 \section{Conclusión}
 
  \subsection{Solución de problemas}

  \begin{frame}{Problemas y soluciones}
   - Ordenacion del vector en los turnos
   - Utilizacion de vectores de bajo nivel fallaba varias
     veces. Solucion: std::vector<> 
   - IA totalmente aleatoria: ponderacion por porcentaje de vida.
   - Fechas en la que nos encontramos xD: solucion retrasar plazos
   - Problema en capas SDL\_Surface. Solucion: redibujado de algunas
     capas en una sola
   - Aceleracion del menu inicial debido a un redibujado de los
     elementos del mismo. Solucion: dibujar los elementos una unica vez

  
  \end{frame}
  
  
 \section{Para terminar}
  \input{../licencia.tex}

  
\end{document}
 
